%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt]{article}
%
\usepackage[a4paper]{geometry}
\usepackage[slovene,english,german]{babel}
\usepackage[T1]{fontenc}
\usepackage[cp1250]{inputenc}
\usepackage{graphicx}
\usepackage{bchart}
\usepackage{fancyhdr}
%
%

\author{Jaka Èop}
\title{Šifriranje od starega Egipta do sodobne kriptografije}

%
\begin{document}
\pagestyle{fancy}
\selectlanguage{slovene}


\begin{centering}
{\huge Gimnazija Viè}\\[.5cm]
{\Large Tržaška cesta 72, Ljubljana}\\
\vfill
{\bf\Large Šifriranje od Julija Cezarja do sodobne kriptografije}\\[1cm]
{\large Jaka Èop, 1. b}\\
\vfill\vfill
{\flushleft\large Mentorja: 
\begin{itemize}
  \item Marina Trost, prof. informatike
  \item Jernej Èop, univ. dipl. matematik
\end{itemize}}
%\vspace{3cm}
\vfill\vfill
{\Large Ljubljana: šolsko leto 2013/14}

\end{centering}
\nopagebreak
%\maketitle
 
%
\newpage
  \abstract{V nalogi bomo poskušali predstaviti zgodovino šifriranja od Julija Cezarja do danes. Èe bomo izpustili kakšno dobro metodo šifriranja, ali ne bomo menili kakšnega pomembnega šifrerja/dešifrerja se opravièujem. Nalogo smo napisali, da bi bralcem predstavili zgodovino šifriranja in jim pomagali razumeti pomembnost današnjega šifriranja. Mislim, da bomo po pregledu projektno nalogo in bomo znali bolj ceniti pomembnost dobrega šifriranja, v prvi svetovni vojni je igralo kljuèno vlogo v zmagi zaveznikov, današnje dni pa je neprecenljivo.}
  \newpage
%
\thispagestyle{empty}
\tableofcontents
\listoftables
\listoffigures
\newpage
%

\section{Uvod}

"`Že tisoèletja se kralji, kraljice in generali zanašajo na hitre in zanesljive poti sporoèanja, da bi lahko vodili svoje države
in vojske. In že od nekdaj tudi vedo, kako hude so lahko posledice, èe bi njihova sporoèila prišla v napaène roke. Tedaj bi
države tekmice ali nasprotnikova vojska izvedele za dobro varovane skrivnosti in odloèilne informacije. Nevarnost, da bi
nasprotnik lahko prestregel takšna pomembna sporoèila, je bila spodbuda za razvoj raznih šifrirnih postopkov. Te tehnike
prikrivanja naj bi zagotovile, da bo sporoèilo znal prebrati samo pravi prejemnik.

Želja, da bi bi doloèena sporoèila ostala tajna, je povzroèila, da so države uvedle svoje tajne službe, ki naj bi razvile
najboljše mogoèe šifre in bile odgovorne za varno prenašanje sporoèil. Hkrati s tem pa so nasprotnikovi dekripterji poskušali
ukrasti te šifre in z njimi tudi razne skrivnosti. Dekripterji so jezikovni alkimisti, z miti obdano pleme, ki poskuša iz vrste
simbolov brez pomena prièarati smiselne besede. Zgodovina tajnih pisav, kodov in šifer je zgodovina stoletja starega boja med
šifrerji in dekripterji, duhovne oboroževalne tekme, ki dramatièno vpliva na potek zgodovine.

Nenehni boj med šifrerji in dekripterji je spodbudil vrsto znanstvenih prebojev. Eni nenehno išèejo nove šifrirne postopke,
drugi pa razvijajo vse moènejše metode za napad nanje. Obe strani, ena, ki išèe vedno nove šifrirne postopke, in druga, ki jih
poskuša èim prej streti, uporabljata celo vrsto znanstvenih disciplin in postopkov, od matematike do jezikoslovja in od
iformatike do kvantne teorije. Šifrerji in dekripterji po svoje bogatijo ta strokovna podroèja, njihovo delo pa pospešuje
tehnièni razvoj, zlasti raèunalništva. Šifre so vpletene v zgodovino, odloèale so o bitkah in povzroèale smrt kronanih glav
\ldots"'

\newpage

\section{Prva Šifriranja}

\subsection{Cezarjanka}
Cezarjeva šifra ali cezarjanka je ena najbolj znanih in najbolj preprostih šifer ter najstarejših starorimskih šifer. Èe stte
mislili, da je šifro razvil Julij Cezar se motite! Razvil jo je Cicerov osvobojeni suženj Tiron. Ker jo je veliko uporabljal za
šifriranje svojih sporoèil se šifra imenuje po njemu.

Gre za monoalfabetsko substitucijsko šifro, saj za vsako èrko odprtega besedila šifrirni kljuè doloèi drugo èrko. V primeru
cezarjeve šifre šifrirni kljuè doloèa za koliko mest se premakne šifrirana abeceda glede na odprto. Pošiljatelj in prejemnik
sporoèila morata uporabiti isto število zamenjave.

\begin{flushleft}
Primer: šifrirni kljuè(premik za 3 mesta)
\end{flushleft}

\begin{table}[h]\centering
%\mbox{}\hspace{-2em}
\setlength{\tabcolsep}{1.5pt}
\begin{tabular}{cccccccccccccccccccccccc}
%  \hline{1-22}
  A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & R & S & T & U & V & Z & &  \\
  D & E & F & G & H & I & J & K & L & M & N & O & P & R & S & T & U & V & Z & A & B & C & &  \\
%  \hline{1-22}
\end{tabular}
\caption{Cezarjev premik: premik za 3 mesta}
\end{table}

\begin{flushleft}
Pa šifrirajmo besedo PONEDELJEK, s šifrirnim kljuèem 3. \\
P $\Rightarrow$ T, O $\Rightarrow$ S, N $\Rightarrow$ R, \ldots\\
\end{flushleft}
\hspace{8em}Dobimo besedo: TSRHGHOMHN\\

Na prvi pogled se zdi beseda nerazpoznavna, a je tako šifro lahko razvozlati saj moraš ugotoviti samo številko zamika abecede,
tukaj pa je samo 22 razliènih možnosti(uporabljena je abeceda brez šumnikov), za kar ti ne bi smelo vzeti preveè èasa. Boljšo
varnost bi lahko ustvarili s tem, da bi šifrirani abecedi nakljuèno razporedili èrke, o tem pa v naslednjem poglavju.
\newpage

\subsubsection{Monoalfabetska substitucija}

Nadrejeni pojem za substitucijo, pri kateri šifrirana abeceda sestoji iz èrk, drugih simbolov in/ali številk, je monoalfabetska šifra. Vse šifre s substitucijo, ki smo jih do zdaj spoznali v tej nalogi, spadajo v to vrsto monoalfabetskega šifriranja.

Možnost, da dekriptiramo šifrirano sporoèilo, ob predpostavki, da poznamo jezik, v katerem je besedilo napisano, je v tem, da poišèemo drugo sporoèilo v istem jeziku, ki je dovolj dolgo, da z njim popišemo en ali dva lista papirja in potem preštejemo, kako pogosto se v njem pojavljajo posamezne èrke. Najpogostejši èrki reèemo prva, drugi najpogostejši druga itn., dokler nismo prešteli vseh èrk v odprtem besedilu.

Potem si natanko ogledamo skrivno besedilo, ki ga želimo dekriptirati, in razvrstimo po številu tudi njegove simbole. Najdemo najpogostejši simbol in mu dodelimo vrednost prve èrke iz preizkusnega odprtega besedila, drugi najpogostejši simbol bo postal druga èrka, tretji najpogostejši tretja èrka in tako naprej, dokler nismo tako obdelali vseh simbolov kriptograma, ki ga želimo odpreti.

%\begin{center}
%\begin{tabular}{c|c|c|c}
%  a & 10,47 & m & 3,30\\
%  b & \phantom{1}1,94  & n & 6,33\\
%  c & \phantom{1}0,66  & o & 9,08\\
%  è & \phantom{1}1,48  & p & 3,37\\
%  d & \phantom{1}3,39  & r & 5,01\\
%  e & 10,71            & s & 5,05\\
%  f & \phantom{1}0,11  & š & 1,00\\
%  g & \phantom{1}1,64  & t & 4,33\\
%  h & \phantom{1}1,05  & u & 1,88\\
%  i & \phantom{1}9,04  & v & 3,76\\
%  j & \phantom{1}4,67  & z & 2,10\\
%  k & \phantom{1}3,70  & ž & 0,65\\
%  l & \phantom{1}5,27  &   & \\
%\end{tabular}
%\end{center}

\begin{bchart}[step=1,max=12]
        \bcbar[text=a]{10.47}
        \bcbar[text=b]{1.94}
        \bcbar[text=c]{0.66}
        \bcbar[text=è]{1.48}
        \bcbar[text=d]{3.39}
        \bcbar[text=e]{10.71}
        \bcbar[text=f]{0.11}
        \bcbar[text=g]{1.64}
        \bcbar[text=h]{1.05}
        \bcbar[text=i]{9.04}
        \bcbar[text=j]{4.67}
        \bcbar[text=k]{3.70}
        \bcbar[text=l]{5.27}
        \bcbar[text=m]{3.30}
        \bcbar[text=n]{6.33}
        \bcbar[text=o]{9.08}
        \bcbar[text=p]{3.37}
        \bcbar[text=r]{5.01}
        \bcbar[text=s]{5.05}
        \bcbar[text=š]{1.00}
        \bcbar[text=t]{4.33}
        \bcbar[text=u]{1.88}
        \bcbar[text=v]{3.76}
        \bcbar[text=z]{2.10}
        \bcbar[text=ž]{0.65}
    \end{bchart}
    \\
\vspace{2em}
Frekvenèna analiza èrk v slovenski abecedi.

\newpage

\subsection{Dekriptiranje šifriranega sporoèila}

\begin{flushleft}
PCQ VMJYPD LBYK LYSO KBXBJXWXV BXV ZCJPO EYPD KBXBJYUXJ LBJOO KCPK. CP LBO LBCMKXPV XPV IYJKL PYDBL, QBOP KBO BXV OPVOV LBO LXRO CI SX'XJMI, KBO JCKO XPV EYKKOV LBO DJCMPV ZOICJO BYS, KXUYPD: "`DJOXL EYPD, ICJ X LBCMKXPV XPV CPO PYDBLK Y BXNO ZOOP JOACMPLYPD LC UCM LBO IXZROK CI FXKL XDOK XPV LBO RODOPVK CI XPAYOPL EYPDK. SXU Y SXEO KC ZCRV XK LC AJXNO X IXNCMJ CI UCMJ SXGOKLU?"'

\vspace{1ex}
OFYRCDMO, LXROK IJCS LBO LBCMKXPV XPV CPO PYDBLK.
\end{flushleft}
Zamislimo si, da smo to šifrirano besedilo prestregli in da ga moramo dekriptirati. Vemo, da gre za angleško besedilo. ki je šifrirano s pomoèjo monoalfabetske substitucije, toda o kljuèu ne vemo nièesar. Vseh mogoèih kljuèev skorajda ni mogoèe preizkusiti, zato moramo paè uporabiti frekvenèno analizo, ki smo jo pojasnili v prejšnjem poglavju. V nadaljevanju bomo postopoma posredovali navodilo za dekriptiranje tega šifriranega besedila, toda kdor si upa, lahko to opravi tudi na lastno pest.

Prva reakcija kriptoanalitika, ki bi dobil v roke takšno šifrirano besedilo, bi seveda bila, ugotoviti frekvenco vsake posamezne èrke. S tem bi dobil tabelo 1. Kot smo prièakovali, se posamezne èrke pojavljajo razlièno pogosto.

\newpage

\subsection{Tajna pisava Marije Stuart}
Zjutraj 15. oktobra 1586 je stopila škotska kraljica Marija Stuart v prenapolnjeneo sodno dvorano na gradu Fotheringhay.
Dolgoletni zapor in zaèetek revmatiènega obolenja sta jo moèno prizadela, vendar ni izgubila svojega dostojanstva, svoje
obvladljivosti in oèitno gosposkega nastopa. Naslonjena na svojega zdravnika je odšla mimo sodnikov, visokih uradnikov in
gledalcev do prestola sredi dolge, ozke dvorane. Prestol je imel za znak spoštovanja, vendar se je motila. Prazen prestol je
simboliziral kraljico Elizabeto, Marijino nasprotnico in tožnico. Z blagim nasiljem so odpeljali Marijo naprej na drugo stran
na drugo stran dvorane, do škrlatno rdeèega žametnega stola, ki je bil namenjen za obtožene.

Marijo Stuart, škotsko kraljico, so obtožili izdajstva. Obdolžili so jo, da je sodelovala pri naèrtovanju umora kraljice
Elizabete I. znamenom, da se sama polasti angleške krone. Sir Francis Walsingham, minister, ki je bil pristojen za Elizabetino
varnost, je dal druge zarotnike že zapreti, od njih izsilil priznanja in jih dal usmrtiti. Zdaj je hotel dokazati, da je bila
Marija srce zarote; s tem je bila enako kriva in si je zaslužila smrt.

Walsingham je natanko vedel, da mora kraljico Elizabeto preprièati o Marijini krivdi, èe jo hoèe dati usmrtiti. Elizabeta je
sicer prezirala Marijo, vendar je imela dobre razloge za to, da se ni odloèila za smrtno kazen. Marija je bila škotska kraljica
in mnogi so dvomili, da je angleško sodišèe pristojno za to, da bi voditeljico tuje države obsodilo na smrt. Usmrtitev Marije
pa bi bila tudi muèen vzorèni primer -- èe je bilo državi dovoljeno, da bi usmrti to kraljico, bodo imeli uporniki manj
pomislekov, da bi ubili drugo monarhinjo, namreè kraljico Elizabeto samo. Poleg tega pa sta bili Elizabeta in Marija sestrièni;
to krvno sorodstvo pa je pripomoglo, da se Elizabeta ni odloèila za to skrajno potezo. SKratka, Elizabeta bi dopustila
usmrtitev Marije samo v primeru, èe bi Walsingham lahko brez kanèka dvoma dokazal, da je bila vpletena v morilsko zaroto.

Zarotniki so bili skupina mladih katoliških plemièev, ki so hoteli Elizabeto, protestantko, odstraniti in namesto nje na
prestol posaditi katolièanko Marijo. Za sodišèe ni bilo nobenega dvoma, da je bila Marija za zarotnike svetel lik, toda ali je
v resnici odobrila to dejanje, še ni bilo dokazano. Marija pa je v resnici blagoslovila to zaroto. Walsingham je bil zdaj pred
nalogo, da dokaže otipljivo povezavo med Marijo in zarotniki.

Marija, obleèena v èrno svilo, je sedela sama pred sodniki. V primeru izdajstva obtoženi niso smeli imeti zagovornika niti niso
smeli navesti nobene prièe. Za pripravo obrambe Mariji niso dovolili niti pomoèi tajnika. Vsekakor pa je vedela, da njen
položaj ni povsem brezupen, saj si je iz previdnosti z zarotniki dopisovala samo v skrivni pisavi. Ta je spreminjala besede v
verige simbolov, ki niso imeli nobenega pomena. Walsingham je morda zaplenil pisma, vendar je bila Marija trdno preprièana, da
tistih simbolov nikoli ne bo mogel razvozlati.\newpage Èe pa bo njihov pomen ostal skrit, pisem nikoli ne bodo mogli uporabiti
kot dokaz proti njej. Vsekakor je vse to temeljilo na domnevi, da tajne pisave niso mogli prebrati. Na Marijino nesreèo pa
Walsingham ni bil samo Elizabetin prvi minister, temveè tudi vodja tajnih agentov v Angliji. Prestregel je Marijina pisma
zarotnikov in pri tem natanko vedel, kdo ima potrebno znanje, da bi jih lahko razvozlal. Thomas Phelippes je bil najveèji
strokovnjak za dekriptiranje šifriranih besedil v državi; že veè let je dekriptiral sporoèila zarotnikov in zbiral dokaze za
njihovo obsodbo. Èe bi lahko dekriptiral tudi obremenjujoèa pisma med Marijo in zarotniki, potem bi bila zapisana smrt. Èe pa
je bila Marijina tajna pisava dovolj moèna, da bo lahko ohranila njene skrivnosti, bi morda ostala pri življenju. Ni bilo
prviè, da je trdnost kakšne tajne pisave odloèala o življenju ali smrti.

\begin{figure}[!htbp]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=.9\textwidth]{./Slike/MarijaStuart.jpg}\\
  \caption{Nomenklator Marije Stuart. Sestavljen je iz šifrirne abecede in kodnih besed.}\label{figure:MarijaStuart}
\end{figure}

Marija in Babington (mož s katerim je kovala zaroto) sta se zaneslana to, da bo njuna šifra skrila njune naèrte, vendar st živela v èasu, ko je napredek na podroèju kriptoanalize oslabil kriptografijo. Njuna šifra bi ju zagotovo varovala pred vsiljivimi pogledi kakšnega laika, proti strokovnjaku za frekvenèno analizo pa ni imela možnosti. Na klopeh za gledalce je sedel Phelippes in brez besed opazoval, kako so predložili dokaze, ki jih je izbral iz dekriptiranih pisem.

8. februarja 1587 se je v veliki dvorani gradu Fotheringhay zbrala tristoglava množica, da bi bila navzoèa pri obglavljanju Marije Stuart. Walsingham se je odloèil, da bo vlogo Marije kot muèenice kar najbolj zmanjšal, zato je vse kar je bilo povezano z usmrtitvijo, ukazal sežgati, da nobena relikvija ne bi prišla v javnost. Vsekakor pa je tudi Marija mislila na to, da bo iz svojega zadnjega nastopa naredila potezo odpora, še enkrat podkrepila katoliško vero in spodbudila svoje privržence.

%\subsection{Le Chiffre indechiffrable}
%
%Preprosta monoalfabetska šifra je veè stoletij dajala dovolj varnosti, dokler je ni pokopal razvoj frekvenène analize v arabskem svetu in Evropi. Ob tragiènem koncu Marije Stuart so se dramatièno pokazale slabosti te šifre. V boju med kriptografi in kriptoanalitiki so slednji oèitno zmagali. Zdaj so bili spet izzvani kriptografi. Razviti so morali novo šifro, tako trd oreh, da ga kriptoanalitiki ne bodo mogli streti. Ta postopek so dokonèno razvili šele proti koncu 16. stoletja, njegovi zaèetki p segajo v 15. stoletje k firenškem matematiku Leonu Battisu Albertiju. Leta 1404 rojeni Alberti je bil imenitna osebnost renesanse: skladatelj, slikar, pesnik in filozof, pa še avtor prve znanstvene perspektive, razprave o hišni muhi. Najbolj znan pa je kot arhitekt, ki je naredil naèrt za prvi rimski vodnjak, za Fontano di Trevi, ter napisal De re aedificatoria, prvo natisnjeno delo o arhitekturi, ki je uèinkovalo kot katalizator prehoda od gotskega gradbenega sloga k renesansi.
%
%Nekega dne okoli leta 1460 se je Alberti sprehajal po vatikanskih vrtovih in naletel na prijatelja Leonarda Data, papeževega tajnika za tajnopisje. Malo sta poklepetala o problemih kriptografije in Alberti je obljubil, da bo napisal razpravo tudi o tem vprašanju, v kateri je po lastnih izjavah razvil novo obliko šifriranja.
%
%Do takrat so pri substitucijskem postopku za šifriranje sporoèil uporabljali samo eno šifrirno abecedo. Alberti pa je zdaj predlagal, da bi uporabljali dve ali veè šifrirnih abeced, med šifriranjem pa prehajali od ene k drugi in tako otežili dekriptiranje.
%
%Albertiju se je sicer posreèil najpomembnejši preboj v kriptografiji v zadnjih tisoè letih, vendar svojega postopka ni razvil naprej vdozorel šifrirni sistem. Ta naloga je pripadla pisani skupini uèenjakov, ki so izhajali iz Albertijeve prvotne ideje. Najprej je na ta naèrt naletel Johannes Trithemius, nemški opat rojen leta 1462, potem italijanski uèenjak Giovanni Porta, rojen leta 1535, in nazadnje še francoski diplomat Blaise de Vigenere, rojen leta 1523.
%
%Vigenere je bil star šestindvajset let, ko je med dvoletno misijo v Rimu naletel na Albertijev zapis. Na zaèetku je zaradi svoje diplomatske dejavnosti samo iz praktiènih razlogov zanimal za kriptografijo. Pri devetintridesetih pa se je odloèil, da si je pridobil že dovolj premoženja in da bo odslej naprej življenje posvetil znanosti. Šele takrat je bolj podrobno preuèil Albertijeve, Trithemiusove in Portove zamisli in posreèilo se mu je, da je iz njih razvil skladen in moèan šifrirni sistem: tako imenovano Vigenereovo šifro.
%
%Pomembne prispevke so sicer dali Alberti, Trithemius in Porta, sam postopek pa se imenuje po èloveku, ki mu je dal konèno podobo. Imenuje se Vigenerova šifra. Njena moè je v tem, da se pri šifriranju sporoèil ne uporablja samo ena, temveè kar 26 šifrirnih abeced. V prvem koraku napišemo Vigenerjev kvadrat, kot je prikazan v tabeli 1. Pod odprto abecedo je razvršèenih 26 šifrirnih abeced, vsaka od njih pa je zamaknjena za eno mesto.
%
%
%\begin{table}
%\centering
%%\mbox{}\kern-10em
%\begin{small}
%\setlength{\tabcolsep}{1pt}
%\begin{tabular}{ccccccccccccccccccccccccccc}
%  \hline
%  % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
%    & a & b & c & d & e & f & g & h & i & j & k & l & m & n & o & p & q & r & s & t & u & v & w & x & y & z \\
%  \hline
%   1 & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A \\
%   2 & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B \\
%   3 & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C \\
%   4 & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D \\
%   5 & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E \\
%   6 & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F \\
%   7 & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G \\
%   8 & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H \\
%   9 & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I \\
%  10 & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J \\
%  11 & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K \\
%  12 & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L \\
%  13 & N & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M \\
%  14 & O & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N \\
%  15 & P & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O \\
%  16 & Q & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P \\
%  17 & R & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q \\
%  18 & S & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R \\
%  19 & T & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S \\
%  20 & U & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T \\
%  21 & V & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U \\
%  22 & W & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V \\
%  23 & X & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W \\
%  24 & Y & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X \\
%  25 & Z & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y \\
%  26 & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
%  \hline
%\end{tabular}
%\end{small}
%
%\caption{Vigenerjev kvadrat}
%\end{table}
%
%Èe bi pošiljatelj uporabljal samo eno od šifrirnih abeced za šifriranje celotnega sporoèila, bi v bistvu šlo samo za preprosto cezarjanko, zelo slabo oblikoo šifriranja, ki bi jo nasprotnikov dekripter brez težav razbil. Pri Vigenerovem šifriranju ravnamo seveda drugaèe. Vsako èrko sporoèila šifriramo s pomoèjo druge vrstice Vigenerovega kvadrata (torej z drugo šifrirno abecedo).
%
%Da bi lahko sporoèilo odprl, pa mora prejemnik vedeti, katera vrsta iz kvadrata je bila pri šifriranju uporabljena. Zato se morata pošiljatelj in prejemnik vnaprej dogovoriti, po katerem pravilu bosta izbirala posamezne vrstice. Ta dogovor zapišeta v obliki kljuène besede. Da bi vam pokazal, kako se takšna kljuèna beseda uporablja v povezavi z Vigenereovim kvadratom, bomo šifrirali sporoèilo Umik vojske proti zahodu s pomoèjo kljuène besede MESTO.
%
%Najprej zapišemo kljuèno besedo nad sporoèilo in jo ponovimo tolikokrat, da je vsaka beseda sporoèila povezana z eno èrko kljuène besede. Šifrirano besedilo dobimo potem takole: da bi šifrirali prvo èrko u, najprej ugotovimo, da nad njo stoji èrka M, ta pa nas usmerja v doloèeno vrstico Vigenerovega kvadrata. Vrstica, ki se zaèenja z M, torej številka 12, vsebuje šifrirno abecedo, ki jo bomo uporabili za to, da najdemo zamenjavo za èrko u odprtega besedila. Torej sledimo stolpcu pod u, dokler ne pridemo do tja, kjer se križa z vrstico M, tam pa stoji èrka G. Zato stoji namesto èrke u v odprtem besedilu èrka G v šifriranem besedilu.
%
%\vspace{2em}
%\mbox{}\kern-8em
%\begin{tabular}{cccccccccccccccccccccc}
%
%  % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
%  Kljuèna beseda & M & E & S & T & O & M & E & S & T & O & M & E & S & T & O & M & E & S & T & O & M \\
%  Odprto besedilo & u & m & i & k & v & o & j & s & k & e & p & r & o & t & i & z & a & h & o & d & u \\
%  Šifrirano besedilo & G & Q & A & D & J & A & N & K & D & S & B & V & G & M & W & H & D & Z & H & R & H \\
%
%\end{tabular}
%\vspace{2em}
%
%Natanèno tako nadaljujemo pri šifriranju druge èrke iz sporoèila. Kljuèna èrka nad m je E in nas napoti na novo vrstico v Vigenerovi tabeli, namreè na èetrto, ki se zaèenja z E in vsebuje drugaèno šifrirno abecedo. Da bi šifrirali èrko m sledimo stolpcu m, dokler ne pridemo do križanja z vrstico E, v tem križišèu pa stoji èrka Q.
%
%Velika prednost Vigenerove šifre je v tem, da je ni mogoèe dekriptirati s pomoèjo frekvenène analize. Kriptoanalitik, ki bi za dekriptiranje uporabil to metodo, bi normalno najprej ugotovil, katera èrka je najpogostejša v šifriranem besedilu, v našem primeru je to èrka H, ter domneval, da je to a, ki je najpogostejša èrka v slovenšèini, kar pa seveda ni res saj predstavlja tri razliène èrke, kar pa je že trd oreh za kriptoanalitika.
%
%Proti Vigenerovi šifri si s frekvenèno analizo ne moremo prav niè pomagati, poleg tega pa omogoèa velikansko število kljuèev. Pošiljatelj in prejemnik se lahko dogovorita za kakšno besedo iz slovarja, za kakršnokoli besedno zvezo, lahko pa uporabita tudi svoje besede. Kriptoanalitiki nikakor ne bi mogel odpreti sporoèila èetudi bi preizkusil vse slovarje, ker je število možnosti preprosto preveliko.
%
%Vigenere je kronal svoje delo leta 1586 z razpravo Traicte des Chiffres. Prava ironija zgodovine je to, da je Thomas Phelippes istega leta dekriptiral šifro Marije Stuart. Ko bi Marijin tajnik prebral to razpravo , bi morda lahko uporabil Vigenerovo šifro, Phelippes bi si na Marijinih sporoèilih Babingtonu polomil zobe in Marijino življenje bi bilo rešeno.
%
%Prav niè nas ne bi presenetilo, èe bi se Vigenerova šifra zaradi svoje trdnosti razširila hitro razširila po vsej Evropi. Zelo verjetno bi bili veseli, da imajo konèno zaneslijivo metodo šifriranja. V resnici pa se je zgodilo ravnno nasprotno: tajni kabineti so Vigenerovo šifro preprosto odložili na stran. Dozdevno brezhiben sistem je bil zapostavljen še naslednji dve stoletji.
%
%%\subsection{Babbage proti Vigenerovi šifri}
%

\newpage
\section{Mehanizirano šifriranje}

\subsection{Dekriptiranje enigme}

Tudi po prvi svetovni vojni so angleški kriptoanalitiki v Room 40 nadzorovali nemške radijske zveze. Toda od leta 1926 naprej so slišali samo radijska poroèila, s katerimi si niso znali pomagati. Enigma se je uveljavila in èim veè teh naprav so uporabljali Nemci, tem manj uspehov so dosegli ljuuje v Room 40. Tudi Amerièani in Francozi so poskušali streti sporoèila, šifrirana z enigmo, vendar prav tako brez uspeha. Nemèija je tedaj imela najvarnejši vojaški telekomunikacijski sistem na svetu.
Kriptoanalitiki zahodnih sil, ki so bili med prvo svetovno vojno še krepko pri stvari, so hitro odnehali. Še deset let pred tem so se zaradi grozeèega poraza noè in dan ukvarjali z nemškimi šiframi. Oèitno sta strah in sovraštvo kljuèni gonilni sili in zelo ugodno delovno okolje za uspešne dekripterje.

Ena država pa si ni mogla privošèiti lenarjenja. Po prvi svetovni vojni je Poljska spet postala samostojna država, toda poljaki so kmalu spoznali, da je njihova na novo pridobljena neodvisnost spet ogrožena. Na vzhodu je ležala Sovjetska zveza, ki si je prizadevala širiti svoj komunizem, na zahodu pa je bila Nemèija, ki je želela spet pridobiti ozemlja, ki jih je bila po vojni prisiljena odstopiti Poljski. Tako uklešèena Poljska je bila hvaležna za vsako informacijo o obeh nasprotnikih, zato je na novo organizirala dekriptersko službo, tako imenovani Biuro Szyfrov. Èe je nujnost mati izumov, potem je sovraštvo mati kriptoanalize. Udarna moè Biuroja Szyfrov se je razloèno pokazala z uspehom v poljsko-sovjetski vojni leta 1919 in 1920. Samo v avgustu leta 1920, ko so sovjetske armade že stale pred vrati Varšave, dekriptirali veè kot 400
sovražnikovih sporoèil. Nadzorovanje nemškega radijskega prometa je bilo prav tako uspešno, dokler niso leta 1926 nemci zaèeli uporabljati enigmo za šifriranje njihovih sporoèil.

Za dekriptiranje nemški radijskih zvez je bil odgovoren stotnik Maksymilian Ciezki, vnet patriot, ki je odrasel v mestu Szamotuty, središèu poljskega nacionalizma. Vendar Ciezki ni imel na voljo nobene verzije enigme, brez poznavanja žiènih povezavv tej vojaški napravi pa ni imel možnosti za dekriptiranje sporoèil nemške vojske. Zaradi tega se je znašel v takšni stiski, da je nekoè v nemoènem besu celo najel jasnovidca, ki naj bi iz prestreženih radijskih pogovorov prièaral kakšen smisel. Ni treba posebej poudarjati,da se tudi jasnovidcu ni posreèil tisti preboj, ki bi ga potrebovali. Tako je ostal prihranjen za Nemca Hansa-Thilo Schmidta, ki je bil razoèaran nad svojo domovino in je pripravil pot za napad na enigmo.

Hans-Thilo Schmidt se je rodil leta 1888 v Berlinu kot drugi sin uglednega profesorja in njegove plemiške žene. Schmidt se je odloèil za kariero v vojski in ji služil med 1. svetovno vojno, toda pri drastiènih redukcijah zaradi versajske pogodbe ga je vojska uvrstil med tiste, ki so bili odveè. Nato je poskusil sreèo kot poslovnež, vendar je moral tovarno mila med hudo inflacijo zapretiin je ostal z družine brez vseh sredstev.

Uspeh njegovega starejšega brata Rudolpha je samo še poveèal njegov obup. Tudi Rudolph je bil med vojno zaposlen v vojski, vendar je v njej delal še naprej. V dvajsetih letih je naredil hitro kariero in je nazadnje napredoval do štabnega poveljnika vojaških komunikacij. Rudolph je bil tisti, ki je odobril uporabo enigme v vojski.

Po propadu svojega podjetja je bil Hans-Thilo prisiljen prositi brata za pomoè, in Rudolph mu je priskrbel delo v berlinskem šifrirnem centru, v službi, ki je bila odgovorna za šifrirano komunikacijo v vojski. Ta šifrirni center je bil tajna komandna centrala za enigmo, v kateri so se izmenjavale strogo zaupne informacije. Ko je Schmidt nastopil novo delo, je pustil svojo družino na Bavarskem, kjer so bili življenjski stroški nižji. Živel je sam v dragem Berlinu, obubožan in brez prijateljev, zavidal je svojemu bratu in bil poln zamer proti državi, ki ni potrebovala njegovega dela. Posledice so bile neizogibne. Schmidt je nekaj denarja zaslužil s tem, da je tajne informacije o enigmi prodajal tujim oboroženim silam, s èimer se je hkrati mašèeval, spodokopaval varnost države in škodil uradu svojega brata.

8.11.1931 se je Schmidt nastanil v hotelu Grand v belgijskem mestu Verviers. Bil je dogovorjen s francoskim agentom, ki je delal pod imenom Rex. Za vrednost 10.000 mark (po današnji vrednosti približno 20.000 dolarjev) je Schmidt dovolil agentu, da je fotografiral  dva dokumenta: Nvodila za uporabo šifrirnega stroja Enigma in Navodila za uporabo kljuèev šifrirnega stroja Enigma. Ti dokumenti sicer niso vsebovali natanènega opisa žiènih povezav v valjih, a so vsebovali dovolj potrebnih podatkov za njihovo razvozlanje.

Zaradi Schmidtove izdaje so zavezniki lahko izdelali natanèen duplikat nemške enigme. Vsekakor pa to ni zadostovalo za dekriptiranje z enigmo šifriranih sporoèil. Trdnost šifre ni odvisna od tega ali stroj ostane v tajnosti, temveè od varovanja tajnosti o njegovi vsakokratni nastavitvi (tj. od kljuèa). Èe hoèe kriptoanalitik dekriptirati prestreženo sporoèilo, mora ne samo imeti duplikat enigme, temveè mora tudi ugotoviti, kateri od veè milijard kljuèev je bil uporabljen za šifriranje posameznega sporoèila.

Francoska tajna služba je oèitno opravila svojo domaèo nalogo, saj je pridobila obvešèevalca in dobila dokumente, ki so vsebovaliinformacije o žiènih povezavah v enigmi. Francoski kriptoanalitiki pa oèitno niso imeli ne volje, ne sposobnosti, da bi znali pravilno oceniti te najnovejše podatke. Po uspehu v prvi svetovni vojni so trpeli zaradi samoprecenjevanja in pomanjkanja motivacije. Bureau du Chiffre je menil, da ni potrebno niti to, da bi izdelal duplikat vojaške enigme, saj je bil preprièan, da je naslednja ovira, namreè najti kljuè za doloèeno z enigmo šifrirano sporoèilo, nepremagljiva.

Naneslo je tako, da so Francozi pred desetimi leti podpisali s Poljsko vojaški sporazum. Poljaki so pokazali zanimanje za vse, kar je bilo povezano z enigmo, zato so Francozi izroèili svojim zaveznikom fotografije Schmidtovih dokumentov in ljudem v Biuro Szyfrow prepustili brezupno nalogo, da bi strli enigmo. Dokumenti so bili zgolj zaèetna pomoè, to so vedeli tudi Poljaki, v nasprotju s Francozi pa so se bali invazije in so zaradi tega imeli dovolj razlogov, da ne opustijo nobene priložnosti. Poljaki so se zagrizli v misel, da mora obstajati kakšna bljižnica, po kateri bi našli kljuè za sporoèilo šifrirano z enigmo. Treba je samo dovolj truda, iznajdljivosti in bistroumnosti pri iskanju te poti.

Scmidtovi dokumenti niso razkrili samo notranje povezave v valjih, natanko so bili opisani tudi kljuèi, ki so jih uporabljali Nemci. Operaterji enigem so vsak mesec dobili novo knjigo kljuèev, ki je za vsak dan predpisovala doloèen kljuè. Za prvi dan v nekem mesecu je knjiga kljuèev naprimer doloèala naslednji dnevni kljuè:

\begin{enumerate}
  \item Povezave na stikalni plošèici: A/L--P/R--T/D--B/W--K/F--O/Y
  \item Položaj valjev: 2-3-1
  \item Osnovna nastavitev valjev: Q-C-W
\end{enumerate}

Položaj valjev in osnovna nastavitev valjev se imenuje konfiguracija valjev. Za ta doloèen dnevni kljuè je moral šifrer svoj šifrirni stroj Enigma nastaviti takole:

\begin{enumerate}
  \item Povezave na stikalni plošèi: Èrki A in L povezati s kablom na stikalni plošèici in ju s tem zamenjati; enako narediti s pari èrk P in R, T in D, B in W, K in F, ter nazadnje še O in Y.
  \item Položaj valjev: Valj 2 vstavi v prvo odprtino za valje, valj 3 v drugo odprtino in valj 1 v tretjo odprtino.
  \item Osnovna nastavitev valjev: Na zunanjem obroèu vsakega valja je vgravirana abeceda, s pomoèjo katere ga lahko postavimo v doloèen položaj. V zgornjem primeru bi šifrer tako dolgo vrtel valj v prvi odprtini, da bi bil zgoraj Q, valj v drugi odprtini tako dolgo, da bi bil zgoraj C, in valj v tretji odprtini tako dolgo, da bi bil zgoraj W.
\end{enumerate}

\newpage

\begin{figure}[!htbp]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=.9\textwidth]{./Slike/EnigmaMachineLabeled.jpg}\\
  \caption{Šifrirni stroj Enigma}\label{Enigma}
\end{figure}


Ena od možnosti je bila, da bi celoten radijski promet enega dneva šifrirali z dnevnim kljuèem. Tedaj so šifrerji z enigmo en cel dan na zaèetku vsakega sporoèila nastavili vsakokratni dnevni kljuè. Vsako radijsko sporoèilo so najprej odtipkali v šifrirni stroj; šifrirano besediloso si zapisali in ga izroèili radiotelegrafistu, da ga je poslal naprej. Na strani prejemnika pa je sporoèilo najprej dobil radiotelegrafist in ga izroèil èloveku, ki je delal z enigmo. Ta ga je spet odtipkal v svoj stzroj, na katerem je že prej nastavil dnevni kljuè. Èrke, ki so se po vrsti prikazovale na plošèici z luèkami, so setavljale odprto besedilo.

Ta postopek je bil dovolj varen, njegova slabost pa je bila v tem, da se dnevni kljuè uporablja vedno znova, morda za pošiljanje kar nekaj sto sporoèil, ki se naberejo vsak dan. Èe se za šifriranje ogromnega števila sporoèila uporablja en sam kljuè, je  za kriptoanalitika navadno lažje kako ga razvozlati. Velika kolièina besedil, ki so enako šifrirana, dajejo kriptoanalitiku veèjo možnost, da odkrije kljuè. Že pri preprostejših postopkih smo videli,da je preprosteje dekriptirati mono alfabetsko šifro, èe je na voljo veè strani šifriranega besedila in ne samo nekaj stavkov.

Na prvi pogled se zdi tak sistem neprebojen, vendar poljski kriptoanalitiki niso izgubili poguma. Bili so pripravljeni izkoristiti vsako možnost samo, da bi našli kakšno šibko toèko v enigmi ter v sistemu individualnih kljuèev. Biuro Szyfrow je organiziral teèaj iz kriptografije ter nanj povabil 20 matematikov. Trije od teh so pokazali veèji talent od ostalih in Biuro jih je zaposlil. Najbolj nadarjen med njimi je bil Marjan Rejewski. Med šolanjem je strl celo vrsto šifer, nazadnje pa so mu predstavili domnevno neprebojno enigmo. Rejewski je delal popolnoma sam in je vse svoje moèi osredotoèil na to, da bi Scherbiusovo napravo spoznal do najmanjše podrobnosti. S pogledom matematika si je posebno natanko ogledal njen naèin delovanja ter prouèeval uèinkovanje valjev in stikalne plošèe. To delo je zahtevalo ne le logièno razmišljanje, temveè tudi navdih.

Strategija, ki jo je izbral Rejewski, je temeljila predvsem na dejstvu, da je ponavljanje sovražnik varovanja tajnosti. Ponavljanja izdajajo doloèene vzorce, ti pa so ljubljenèki kriptoanalitikov. Najbolj oèitna ponavljanja pri sporoèilih, šifriranih z enigmo so bili individualni kljuèi, ki so bili na zaèetku vsakega sporoèila. Èe je šifrer na primer izbral individualni kljuè ULJ, potem ga je šifriral dvakrat in iz ULJULJ morda dobil PEFNWZ, zaporedje èrk, ki je bilo potem poslano na zaèetku vsakega sporoèila. Nemci so to ponavljanjepredpisali zato, da bi prepreèili napake zaradi interference, ali zaradi napaènega vnašanja podatkov. Da bodo s tem ogrozili varnost šifriranja niso pomislili.

Rejewski je dobil vsak dan na pisalno mizo kup prestreženih sporoèil, vsa so se zaèenjala s šestimi èrkami individualnega kljuèa iz treh èrk, ki so bili vsi šifrirani po dogovorjenem dnevnem kljuèu. Tako je naprimer dobil štiri radijska sporoèila, ki so se zaèenjala z naslednjimi individualnimi kljuèi:

\vspace{2em}
\begin{table}[h]\centering
\begin{tabular}{ccccccc}
  % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
  1. sporoèilo & L & O & K & R & G & M \\
  2. sporoèilo & M & V & T & X & Z & E \\
  3. sporoèilo & J & K & T & M & P & E \\
  4. sporoèilo & D & V & Y & P & Z & X \\
\end{tabular}
\caption{Individualni kljuèi}
\end{table}
\vspace{2em}

\newpage
Prve in èetrte èrke so zagotovo šifrirane iste èrke sporoèila, namreè prve iz individualnega kljuèa, tako tudi druge in pete, ter tretje in šeste. V prvem radijskem sporoèilu sta torej L in R isti èrki. Vzrok zakaj je ta èrka razlièno šifrirana, najprej kot L in potem kot R, je preprosto to, da se je prvi valj med eno in drugo èrko premaknil za tri korake in s tem spremenil pot šifriranja.

Dejstavo, da sta L in R šifri za isto èrko, je dalo Rejewskemu namig o prvotni nastavitvi enigme. S to osnovno nastavitvijo, ki je ni poznal, je šifriral prvo èrko dnevnega kljuèa, ki je prav tako ni poznal, v L, poznejši položaj valjev, prav tako nepoznan, vendar tri korake oddaljen od osnovne nastavitve, pa je šifriral isto èrko v R.

Ta ugotovitev se morda zdi še nejasna, ker je še preveè neznank, ki so pri tem pomembne, kaže pa vsaj to, da sta èrki L in R, pogojno s temeljno nastavitvijo enigme, namreè z dnevnim kljuèem, nujno povezani. Z vsakim novim prestreženim sporoèilom je odkrival nove povezave med prvo in èetrto èrko ponovlenega individualnega kljuèa. V vseh teh odnosih se zrcali osnovna nastavitev enigme. Drugo radijsko sporoèilo na zgornjem seznamu, nam pove, da sta M in X med seboj povezana, tretje pa povezuje J in M, èetrto pa D in P. Rejewski je vse te odnose strnil v posebni tabeli. Za dosedanja štiri radijska sporoèila kaže tabela povezanost med (L, R), (M, X), (J, M), (D, P):

\begin{table}\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{ccccccccccccccccccccccccccc}
  Prva èrka  & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
  Druga Èrka &   &   &   & P &   &   &   &   &   & M &   & R & X &   &   &   &   &   &   &   &   &   &   &   &   &
\end{tabular}
\caption{Tabela povezanosti 1}
\end{table}

Èe je prisluškovalna služba dala Rejewskemu v enem dnevu dovolj sporoèil je lahko izpolnil abecedo teh povezav:

\begin{table}\centering
\setlength{\tabcolsep}{1pt}
\begin{tabular}{ccccccccccccccccccccccccccc}
  Prva èrka  & A & B & C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z \\
  Druga Èrka & F & Q & H & P & L & W & O & G & B & M & V & R & X & U & Y & C & Z & I & T & N & J & E & A & S & D & K
\end{tabular}
\caption{Tabela povezanosti 2}
\end{table}

Rejewski ni poznal dnevnega kljuèa in tudi ni vedel, kateri individualni kljuèi so bili izbrani, vendar je vedel, da rezultirajo v tej tabeli odnosov. Èe bi bil dnevni kljuè drugaèen, bi bila tudi ta tabela popolnoma drugaèna. Naslednje vprašanje je bilo, ali je mogoèe s pomoèjo te tabele odkriti dnevni kljuè. Rejewski je zaèel iskati vzorce v tabeli, strukture, ki bi morda kazale na dnevni kljuè. Nazadnje je zaèel raziskovati doloèen vzorec, ki ga je dobil iz èrkovnih verig. V zgornji tabeli , na primer, je A v zgornji vrstici povezan s F v spodnji. Rejwski je poiskal zdaj F v zgornji vrstici, ugotovil je da je povezan z W, zato je poiskal W v zgornji vrstici. In ta W je bil konèno spet povezan z A, s katerim je zaèel. Veriga je bila zakljuèena.

Rejewski je enako storil še z drugimi èrkami abecede in sestavil razliène verige. Napisal jih je skupaj in za vsasko zapisal število povezav v vsaki verigi:

\noindent
A $\Rightarrow$ F $\Rightarrow$ W $\Rightarrow$ A 3 povezave\\
B $\Rightarrow$ Q $\Rightarrow$ Z $\Rightarrow$ K $\Rightarrow$ V $\Rightarrow$ E $\Rightarrow$ L $\Rightarrow$ R $\Rightarrow$ I $\Rightarrow$ B 9 povezav\\
C $\Rightarrow$ H $\Rightarrow$ G $\Rightarrow$ O $\Rightarrow$ Y $\Rightarrow$ D $\Rightarrow$ P $\Rightarrow$ C 7 povezav\\
J $\Rightarrow$ M $\Rightarrow$ X $\Rightarrow$ S $\Rightarrow$ T $\Rightarrow$ N $\Rightarrow$ U $\Rightarrow$ J 7 povezav\\

Ugotovil je, da se verige vsak dan spreminjajo. Vèasih je dobil veliko kratkih verig, drugiè malo dolgih. Seveda so se spreminjale tudi èrke v verigah. Lastnosti verig so bile oèitno posledica vsakokratnega dnevnega kljuèa - kar je po zapleteni poti dosežen uèinek kabelskih povezav na plošèi s stikali, položaja valjev in nastavitve valjev. Vsekakor je še vedno obstajalo vprašanje, kako bi Rejewski iz teh verig dobil dnevni kljuè. Kateri od 10 000 000 000 000 000 možnih dnevnih kluèev tièi za posameznim vzorcem verig? Število možnosti je bilo kratko malo preveliko.

Na tej toèki je Rejewski sprejel pomembno ugotovitev. Plošèa s stikali in konfiguracija valjev skupaj sicer vplivata na natanèno sestavo verig, toda vpliv in druge je mogoèe v doloèeni meri razdvojiti. Posebno ena lastnost verig je odvisna izkljuèno od položaja in nastavitve valjev in nima nobene povezave z povezavami na stikalni plošèi: namreè število povezav znotraj verig. Vzemimo zgornji primer in naredimo tako, kot je zahteval dnevni kljuè, namreè s pomoèjo povezave na stikalni plošèi zamenjamo èrki S in G. Èe spremenimo ta sestavni del dnevnega kljuèa, in sicer tako, da odstranimo kabel, ki zamenjuje S in G, in namesto tega zamenjamo T in K, se verige spremenijo takole:

\noindent
A $\Rightarrow$ F $\Rightarrow$ W $\Rightarrow$ A 3 povezave\\
B $\Rightarrow$ Q $\Rightarrow$ Z $\Rightarrow$ T $\Rightarrow$ V $\Rightarrow$ E $\Rightarrow$ L $\Rightarrow$ R $\Rightarrow$ I $\Rightarrow$ B 9 povezav\\
C $\Rightarrow$ H $\Rightarrow$ S $\Rightarrow$ O $\Rightarrow$ Y $\Rightarrow$ D $\Rightarrow$ P $\Rightarrow$ C 7 povezav\\
J $\Rightarrow$ M $\Rightarrow$ X $\Rightarrow$ G $\Rightarrow$ K $\Rightarrow$ N $\Rightarrow$ U $\Rightarrow$ J 7 povezav\\

Nekaj èrk v verigah se spremeni, število povezav v vsaki verigi pa ostane enako. Rejewski je odkril lastnosti verig, v katerih se odraža samo konfiguracija valjev.
Celotno število konfiguracij valjev je število možnih položajev valjev (6), pomnoženo s številom nastavitev valjev (17.576), torej 105.456. Zdaj se Rejewskemu ni bilo treba veè ibadati z vprašanjem kateri od 10 000 000 000 000 000 dnevnih kljuèev je dal doloèeno skupino verig. Lahko se je ukvarjal z drastièno preprostejšim problemom: katera od 104.456 možnih konfiguracij tièi za številom povezav znotraj doloèene skupine verig? To število je še vedno veliko, vsekakor pa stomilijardkrat manjše od skupnega števila kljuèev.

Rejewski je ravnal takole. Vohunu Hansu-Thilo Schmidtu se je moral zahvaliti, da je lahko delal z identiènim, na novo izdelanim šifrirnim strojem enigma. Njegovi ljudje so se vrgli na delo in zaèeli preverjati vsako od 104.456 možnih konfiguracij valjev in si zapisovali vsakokrat nastalo dolžino verig. Potrebovali so celo leto, da so sestavili katalog, toda takoj ko je Biuro zbral vse podatke, je Rejewski konèno zaèel z dekriptirati z enigmo izdelane šifrate.

Vsak dan si je ogledal šifrirane individualne kljuèe, prvih šest èrk vseh prestreženih sporoèil, in sestavil svoje tabele. Ko jih je imel pri roki, je lahko èrke povezal v verige in za vsako verigo doloèil število povezav. Tako je na primer z analizo prvih in èetrtih èrk dobil štiri verige z 3, 9,7 in 7 povezavami. Druga in peta èrka sta dali verige štiri verige z 2, 3, 9 in 12 povezavami. Tretje in šeste èrke pa so dale pet verig s 5, 5, 5, 3 in 8 povezavami. Dnevnega kljuèa Rejewski sicer še vedno ni vedel, vendar je vedel, da je ta dnevni kljuè oblikoval tri skupine verig z naslednjimi znaèilnostmi:

4 verige iz prvih in èetrtih èrk, s 3, 9, 7 in 7 povezavami
4 verige iz drugih in petih èrk, s 2, 3, 9 in 12 povezavami
5 verig iz tretjih in šestih èrk, s 5, 5, 5, 3 in 8 povezavami

Zdaj si je Rejewski lahko pomagal s svojim katalogom, saj so bile v njem vse konfiguracije valjev, urejene po vsakokrat nastalih verigah. Takoj, ko je našel vnos v katalog s pravilnim številom verig in pravilnim številom povezav, je poznal konfiguracijo valjev, ki jo je predvideval vsakokratni dnevni kljuè. Verige so bile hkrati nekakšni prstni odtisi, ki so pripeljali na sled konfiguracije valjev. Rejewski je delal kot nekakšen detektiv, ki na prizorišèu zloèina najdeprstni odtis in ga potem s pomoèjo banke podatkov poveže s kakšnim osumljencem.

Rejewski je zdaj sicer našel valjèni del dnevnega kljuèa, povezav na stikalni plošèi pa še vedno ni poznal. Èeprav obstaja skoraj sto milijard možnosti za te povezave, je bila naloga sorazmerno preprosta. Rejewski je najprej nastavil valje na svoji enigmi skladno s pravkar odkritim delom dnevnega kljuèa za valje. Potem je odstranil vse kable na stikalni plošèi, ki tako ni veè vplivala na šifriranje. Nazadnje je vzel prestrežen šifrat in ga vnesel v enigmo. Dobil je veèinoma nesmisel saj je manjkala kabelska povezava na stikalni plošèi in tudi ta ni bila znana. Toda tu in tam so se le pojavili besedam podobni deli, na primer alkultilbernil - verjetno bi moralo pisati "Ankunft in Berlin" (prihod v Berlin). Èe je bila ta domneva pravilna, sta morali biti èrki R in L med seboj povezani, to je, s kablom na stikalni plošèi zamenjani, èrke A, K, U, F,T, I, B in E pa ne. Z analizo nadaljnjih zaporedij èrk je bilo mogoèe odkriti še druge pare èrk, ki so bile na stikalni plošèi med seboj zamenjane. Rejewski je imel zdaj v rokah povezave na stikalni plošèi skupaj s konfiguracijo valjev, torej popoln dnevni kljuè. S tem je lahko dešifriral vsako sporoèilo tistega dne.

Rejewski je iskanje dnevnega kljuèa silno popreprostil s tem, ko je problem konfiguracije valjev loèil od od problema povezav na stikalni plošèi. Vsaka zase sta bili obe zadevi rešljivi. V zaèetku smo ocenjevali, da bi trajalo dlje od življenjske dobe vesolja, da bi preizkusili vsak možni kljuè enigme. Rejewski je potreboval samo eno leto, da je sestavil katalog dolžine verig, od takrat naprej pa je lahko odkril dnevni kljuè, še preden je bil dan pri koncu. Zdaj, ko je poznal ta kljuè je lahko sporoèila bral kot pravi prejemnik.

Z epohalnim uspehom Rejewskega je nemški radijski promet postal odprta knjiga. Poljaki niso bili v vojni z Nemci, vendar so èutili, da jim grozi invazija, in jim je silno odleglo, ko so razrešili skrivnost enigme. Zdaj so lahko ugotovili kakšne naèrte imajo nemški generali, in so tako imeli veè možnosti za uspešno obrambo. Od tega dela Rejewskega je bila odvisna usoda poljskega naroda, in svoje države res ni razoèaral.

\begin{figure}[!htbp]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=.9\textwidth]{./Slike/Marian_Rejewski.jpg}\\
  \caption{Marian Rejewski}\label{Marian Rejewski}
\end{figure}

\newpage

\section{Moderno šifriranje}

\subsection{Alice in Bob se predstavita}

"`Prišel sem v pisarno Rona Rivesta,"' se spominja Leonard Adleman. Ron je v roki držal èlanek, zaradi katerega je bil precej razburjen. Tisto kar je Ron Rivest držal v rokah, je bil èlanek Diffieja in Hellmana, v katerem sta predstavila svojo idejo enosmernega šifriranja. Nazadnje je Rivest preprièal Adlemana, da se v tem problemu skrivajo zanimiva matematièna vprašanja, in odloèila sta se, da bosta poiskala enosmerno funkcijo, ki bo ustrezala zahtevam. Pri tem lovu je sodeloval tudi Adi Shamir. Vsi trije so delali kot raziskovalci v osmem nadstropju MIT-ovih laboratorijev za raèunalniške vede.

Rivest, Shamir in Adleman so sestavljali odlièno ekipo. Rivest, raèunalniški strokovnjak, je imel to izredno sposobnost, da je znal sprejeti nove ideje in jih uporabiti na podroèjih, na katera ne bi nihèe pomislil. Shamir, prav tako raèunalniški strokovnjak, je imel bliskovit razum in je bil sposoben vse nepomembno pustiti ob strani in se osredotoèiti na glaven problem. Adleman, kot matematik vzdržljiv, temeljit in potrpežljiv, je bil pristojen predvsem zato, da je odkrival napake v idejah Rivesta in Shamirja.Rivest in Shamir sta eno leto razvijala ideje, Adleman pa je to leto preživel tako, da je ovrgel prav vse njune ideje. Trojka je poèasi izgubljala upanje, vendar je vedela,da so neuspehi kljuèni na poti do uspeha in njihova prizadevanja so bila kmalu nagrajena.

Aprila leta 1977 so Rivest, Shamir in Adleman v hiši nekega študenta preživljali praznik judovske paše. Popili so precej vina in se okoli polnoèi odpeljali domov. Rivest ni mogel zaspati in je z matematiènim uèbenikom legel na kavè. Zaèel je razmišljati o problemi s katerim se je že dolgo ukvarjal. ALi je mogoèe razviti asimetrièno šifriranje? Ali je mogoèe najti takšno enosmerno funkcijo, ki jo je mogoèe obrniti samo èe ima naslovnik doloèeno informacijo?? Nenadoma se je megla zbistrila in ideja je bila tu. Preostanek noèi je preživel z matematiènim obdelovanjem svoje ideje in še pred prvim svitom je imel napisan popoln znanstveni èlanek. Rivestu se je posreèil preboj, vendar njegov uspeh ne bi bil mogoè brez dolgoletnega sodelovanja z Adlemanom in Shamirjem. Na koncu èlanka je navedel avtorje po abecedi: Adleman, Rivest in Shamir.

 Naslednje jutro je Rivest izroèil dokument Adlemanu, ki je kot ponavadi poskušal ovreèi argumentacijo, vendar tokrat ni mogel najti nobene napake. Samo proti seznamu avtorjev je ugovarjal:"`ROnu sem rekel naj moje ime èrte, saj je bila to vendar njegova iznajdba, ne moja. Toda Ron je temu ugovarjal in zaèela sva se prepirati. Nazadnje sva se dogovorila, da bom dokument odnesel domov in ga natanèno pregledal. Naslednji dan sem ROnu predlagal, naj me imenuje na tretjem mestu. Vem še, da sem si mislil, da bo to zanimiv èlanek, ki bo nosil moje ime."' Adleman se je zelo motil. Postopek, ki so ga poimenovali ne ARS, ampak RSA.

 Kaj so znanstveniki pravzaprav iskali, da bi v praksi lahko uporabljali asimetrièno šifriranje.

 \begin{enumerate}
   \item Alice mora sestaviti javni kljuè, ki ga bo javno izroèila Bobu (in drugim), da bo lahko šifriral njej namenjena sporoèila. Javni kljuè mora biti enosmerna funkcija, torej mora biti praktièno nemogoèe, da bi kdo to funkcijo obrnil in dešifriral sporoèilo za Alice.
   \item Alice mora imeti možnost za dešifriranje njej namenjenih sporoèil. Za ta namen potrebuje zasebni kljuè, poseben košèek informacije, ki ji bo omogoèil obrniti javni kljuè. Tako ima Alice (in samo Alice) možnost za dekriptiranje njej namenjenih sporoèil.
 \end{enumerate}

\begin{figure}[!htbp]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=.9\textwidth]{./Slike/asymmetric_encryption_diagram.jpg}\\
  \caption{Asimetrièno šifriranje}\label{Asimetrièno šifriranje}
\end{figure}

\newpage
\subsubsection{Matematika RSA}

Sledi opis èisto matematiène funkcije za šifriranje s postopkom RSA.

\begin{enumerate}
  \item Alice izbere dve velikanski praštevili, p in q. Praštevili naj bi bili zelo veliki, zaradi preprostosti pa bomo kot primer vzeli, da je Alice izbrala p=17 in q=11. Ti števili mora skrbno ohraniti samo zase.
  \item ALice pomnoži praštevili med seboj in dobi novo število, v tem primeru N=187. Zdaj izbere še eno število, e, na primer e=7.(e in (p-1)*(q-1)) naj bi bili brez skupnega delitelja, vendar je to že tehnièna podrobnost.
  \item Zdaj lahko Alice e in N objavi v javnem seznamu. Ker sta obe števili potrebni za šifriranje, morata biti dostopni vsem, ki želijo šifrirati sporoèilo za Alice. Tvorita tako imenovani javni kljuè. (Število e ni rezervirano za Alice, lahko je sestavni del tudi drugih javnih kljuèev. Vsekakor pa morajo biti vrednosti N, ki so odvisne od vsakokrat izbranega p in q, za vsak kljuè drugaène.)
  \item Da bi sporoèilo lahko šifrirali, ga moramo najprej spremeniti v število M. Tako lahko na primer besedo po kodi ASCII spremenimo v binarno število, ki ga potem za namen šifriranja lahko obravnavamo kot decimalno število M. Ta M šifriramo in dobimo tajno besedilo po naslednji formuli.
  $$
    C=M^{e}\pmod N
  $$
  \item Vzemimo, da želi Bob poslati samo simbolièen znak za poljuben X. V kodi ASCII je predstavljen kot 1011000, kar ustreza decimalnemu številu 88. Zato je M=88.
  \item Da bi sporoèilo šifriral, Bob najprej poišèe Alicein javni kljuè, torej N=187 in e=7. Ti števili lahko vstavi v šifrirano formulo Alice namenjenega sporoèila. Pri M=88 dobimo formulo
  $$
    C=88^{7} (\bmod 187)
  $$
  \item Žepni raèunalnik ni dober za takšne izraèune, saj zaslon sploh ne more prikazati naravnost astronomski številk. Vsekakor pa obstaja dober trik za izraèunavanje potenc v modularni aritmetiki. Ker je 7=4+2+1, vemo tudi naslednje:
  \begin{eqnarray}
          % \nonumber to remove numbering (before each equation)
          \nonumber
            88^7 \bmod 187 &=& [88^4(\bmod 187)\times 88^2(\bmod 187)\times 88^1(\bmod 187)]\bmod187 \\
          \nonumber
            88^1 &=& 88(\bmod 187) \\
          \nonumber
            88^2 &=& 77(\bmod 187) \\
          \nonumber
            88^4 &=& 132(\bmod 187) \\
          \nonumber
            88^7 &=& 11(\bmod 187)
  \end{eqnarray}

  Zdaj Bob pošlje Alice šifrirano besedilo, C=11

  \item Vemo, da so eksponenti v modularni aritmetiki enosmerne funkcije, zato se je zelo težko vrniti iz C=11 in odkriti prvotno sporoèilo M Eve sporoèila torej ne more odpreti.
  \item Alice pa lahko sporoèilo prebere, ker ima za to potrebne podatke: vrednosti p in q. Najprej izraèuna posebno število d, tako imenovani kljuè za dešifriranje, imenovan tudi zasebni kljuè. Število d se izraèuna po naslednji formuli:
  \begin{eqnarray}
  % \nonumber to remove numbering (before each equation)
  \nonumber
    e\times d &=& 1(\bmod (p-1)\times (q-1)) \\
  \nonumber
    7\times d &=& 1(\bmod 16\times 10) \\
  \nonumber
    7\times d &=& 1(\bmod 160) \\
  \nonumber
    d &=& 23
  \end{eqnarray}

  (Vrednosti d ne dobimo neposredno, s tako imenovanim Evklidovim algoritmom pa sorazmerno preprosto in hitro).

  \item Da bi sporoèilo dešifrirala, Alice preprosto uporabi naslednjo formulo:
  \begin{eqnarray}
  % \nonumber to remove numbering (before each equation)
  \nonumber
    M &=& C^d (\bmod 187) \\
  \nonumber
    M &=& 11^{23}(\bmod 187) \\
  \nonumber
    M &=& 11^1(\bmod 187)\times 11^2(\bmod)\times 11^4(\bmod 187)\times 11^6(\bmod 187)](\bmod 187) \\
  \nonumber
    M &=& [11\times 121\times 55\times 154](\bmod 187) \\
  \nonumber
    M &=& 88 \\
  \nonumber
    M &=& X\;\;\mathrm{v}\;\;\mathrm{ASCII}
  \end{eqnarray}

  Rivest, Shamir in Adleman so s tem ustvarili posebno enosmerno funkcijo, ki jo je mogoèe obrniti samo, èe poznamo tajni vrednosti p in q. Vsak uporabnik te funkcije ju lahko priredi zase z izbiro vrednosti p in q, ki med seboj pomnoženi dasta N. S tem osebnim N lahko šifriramo sporoèila, ki jih lahko dešifrira samo upravièeni prejemnik, ker paè samo on pozna p in q in s tem tudi kljuè za dešifriranje d.

\begin{figure}[!htbp]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=.9\textwidth]{./Slike/aliceandbob.jpg}\\
  \caption{Alice in Bob}\label{Alice in Bob}
\end{figure}


\end{enumerate}

\newpage

\section{Zakljuèek}
Zgodovina nas uèi, da so ljudje zaèeli šifrirati besedila kmalu potem, ko so izumili pisavo. Izumljali so vedno nove metode, ki so bile zmeraj bolj zapletene. Od skrivnih pisav, enostavnih zamenjav èrk in znakov preko bolj zapletenih zamenjav z uporabo kljuèev, kot je na primer Vigen\`{e}rjeva šifa, kjer se ista èrka vsakiè znova transformira v drugo èrko. Dešifrerji so vse uspeli dešifrirati. 

Z uporabo strojev se je šifriranje mehaniziralo. Najbolj znana je uporaba nemške Enigme med drugo svetovno vojno. In tudi to je uspelo bistrim umom dešifrirati. Najprej Marian Rejevski in za njim Alan Turing. Slednji velja za oèeta raèunalnika. Z uporabo "`velikih"' strojev -- imenovanih "`bombe"' je skupina pod vodstvom Alana Turinga v Bletchley parku dnevno raèunala kljuèe Enigme in s tem omogoèala zaveznikom, da so lahko brali nemška sporoèila. Žalostna usoda, ki je po vojni zaradi homoseksualnosti doletela Alana Turinga -- zaradi pritiska javnosti je naredil samomor -- se najbolje odraža v komentarju nekega lorda, ki je Turinga vseskozi tudi in predvsem moralno podpiral: "`Kaj bi šele bilo, èe bi se to razvedelo prej. Utegnili bi celo izgubiti vojno."'

Razvoj šifriranja v sedanjem èasu narekujejo raèunalniki. Vendar pa razvoj metod še vedno temelji na bistrosti èloveškega uma. Sodobne metode uporabljajo matematiko in velika praštevila. Uporaba slednjih nam je prinesla asimetrièno šifriranje, ki služi ne samo šifriranju sporoèil, ampak tudi elektronkemu podpisovanju dokumentov, ki je že z zakonom izenaèeno lastnoroènemu podpisovanju.

Ne glede na to, kako bistri in iznajdljivi so bili šifrerji skozi zgodovino -- in vedno korak pred dešifrerji -- so jih slednji vedno "`ujeli"'. Sodobne metode lahko "`bežijo"' z uporabo vedno daljših kljuèev -- z uporabo vedno veèjih praštevil, vendar jim vedno veèja raèunalniška moè združena v gruèe raèunalnikov vedno bolj "`diha za ovratni"'. Kako dolgo še, bo zgolj daljšanje kljuèev vzdržalo napade dešifrerjev? 


%\section{Viri}
\newpage
\begin{thebibliography}{99}

  \bibitem{buchmann}	BUCHMANN, J. A., 2004, Introduction to cryptography, Springer-Verlag NY
  \bibitem{oetiker} 	OETIKER, Tobias, 2006, Ne najkrajši uvod v \LaTeX 2e
  \bibitem{singh 1}	SINGH, Simon, 2006, Knjiga šifer
  \bibitem{singh 2}	SINGH, Simon: The Code Book, Crypto CD ROM
  \bibitem{wikibook}	Wikibooks, Open book for an open world:\\ \verb+http://en.wikibooks.org/wiki/Cryptography+
  \bibitem{wikipedia 1}	Wikipedia, the Free Encyclopedia: \verb+http://en.wikipedia.org/+
  \bibitem{wikipedia 2} Wikipedia, Cryptography Portal: \verb+http://en.wikipedia.org/wiki/Portal:Cryptography+
  \bibitem{sp. stran 1}	\verb+http://simonsingh.net/cryptography/+
  \bibitem{sp. stran 2}	Journey into Cryptography: \verb+https://www.khanacademy.org/math+\\
    \verb+/applied-math/cryptography+
  \bibitem{sp. stran 3}	Uporaba kriptografije v internetu: \verb+http://www.si-ca.si/kripto/index.htm+

\end{thebibliography}

\end{document}
